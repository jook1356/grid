<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PureSheet Demo</title>
  <link rel="stylesheet" href="../src/ui/style/default.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    
    h1 {
      margin-bottom: 20px;
      color: #333;
    }
    
    .demo-container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    .toolbar {
      padding: 12px 16px;
      background: #f9f9f9;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .toolbar button {
      padding: 8px 16px;
      background: #1976d2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .toolbar button:hover {
      background: #1565c0;
    }
    
    .toolbar button.secondary {
      background: #666;
    }
    
    .toolbar button.secondary:hover {
      background: #555;
    }
    
    #grid {
      height: 500px;
    }
    
    .status-bar {
      padding: 12px 16px;
      background: #f9f9f9;
      border-top: 1px solid #e0e0e0;
      font-size: 14px;
      color: #666;
    }
    
    .info-panel {
      margin-top: 20px;
      padding: 16px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .info-panel h3 {
      margin-bottom: 12px;
      color: #333;
    }
    
    .info-panel pre {
      background: #f5f5f5;
      padding: 12px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <h1>ğŸ—ƒï¸ PureSheet Demo</h1>
  
  <div class="demo-container">
    <div class="toolbar">
      <button onclick="loadData(1000)">1,000 í–‰ ë¡œë“œ</button>
      <button onclick="loadData(10000)">10,000 í–‰ ë¡œë“œ</button>
      <button onclick="loadData(100000)">100,000 í–‰ ë¡œë“œ</button>
      <button class="secondary" onclick="selectAll()">ì „ì²´ ì„ íƒ</button>
      <button class="secondary" onclick="clearSelection()">ì„ íƒ í•´ì œ</button>
      <button class="secondary" onclick="toggleTheme()">í…Œë§ˆ ì „í™˜</button>
    </div>
    
    <div id="grid"></div>
    
    <div class="status-bar" id="status">
      ì¤€ë¹„ë¨
    </div>
  </div>
  
  <div class="info-panel">
    <h3>ì„ íƒëœ í–‰</h3>
    <pre id="selectedRows">[]</pre>
  </div>
  
  <script type="module">
    // ë¹Œë“œëœ ëª¨ë“ˆ ëŒ€ì‹  ì§ì ‘ import (ê°œë°œìš©)
    // ì‹¤ì œ ì‚¬ìš© ì‹œ: import { PureSheet } from '@puresheet/core';
    
    // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
    function generateData(count) {
      const statuses = ['Active', 'Inactive', 'Pending', 'Suspended'];
      const departments = ['Engineering', 'Sales', 'Marketing', 'HR', 'Finance'];
      
      return Array.from({ length: count }, (_, i) => ({
        id: i + 1,
        name: `User ${i + 1}`,
        email: `user${i + 1}@example.com`,
        department: departments[i % departments.length],
        status: statuses[i % statuses.length],
        salary: Math.floor(50000 + Math.random() * 100000),
        joinDate: new Date(2020, Math.floor(Math.random() * 48), Math.floor(Math.random() * 28) + 1).toISOString().split('T')[0],
      }));
    }
    
    // PureSheet ì¸ìŠ¤í„´ìŠ¤ (ì „ì—­)
    let sheet = null;
    let isDarkTheme = false;
    
    // ìƒíƒœ ì—…ë°ì´íŠ¸
    function updateStatus(message) {
      document.getElementById('status').textContent = message;
    }
    
    function updateSelectedRows(rows) {
      const display = rows.slice(0, 10).map(r => ({ id: r.id, name: r.name }));
      if (rows.length > 10) {
        display.push({ '...': `ì™¸ ${rows.length - 10}ê°œ` });
      }
      document.getElementById('selectedRows').textContent = JSON.stringify(display, null, 2);
    }
    
    // ì „ì—­ í•¨ìˆ˜ (ë²„íŠ¼ì—ì„œ í˜¸ì¶œ)
    window.loadData = async function(count) {
      updateStatus(`${count.toLocaleString()}ê°œ ë°ì´í„° ìƒì„± ì¤‘...`);
      
      const startTime = performance.now();
      const data = generateData(count);
      const genTime = performance.now() - startTime;
      
      updateStatus(`ë°ì´í„° ë¡œë“œ ì¤‘...`);
      
      if (sheet) {
        const loadStart = performance.now();
        await sheet.loadData(data);
        const loadTime = performance.now() - loadStart;
        
        updateStatus(`${count.toLocaleString()}ê°œ í–‰ ë¡œë“œ ì™„ë£Œ (ìƒì„±: ${genTime.toFixed(0)}ms, ë¡œë“œ: ${loadTime.toFixed(0)}ms)`);
      }
    };
    
    window.selectAll = function() {
      if (sheet) {
        sheet.selectAll();
        updateStatus('ì „ì²´ ì„ íƒë¨');
      }
    };
    
    window.clearSelection = function() {
      if (sheet) {
        sheet.clearSelection();
        updateStatus('ì„ íƒ í•´ì œë¨');
        updateSelectedRows([]);
      }
    };
    
    window.toggleTheme = function() {
      isDarkTheme = !isDarkTheme;
      const container = document.querySelector('.ps-grid-container');
      if (container) {
        container.classList.toggle('ps-theme-dark', isDarkTheme);
      }
      updateStatus(`í…Œë§ˆ: ${isDarkTheme ? 'ë‹¤í¬' : 'ë¼ì´íŠ¸'}`);
    };
    
    // ì´ˆê¸°í™”
    async function init() {
      const container = document.getElementById('grid');
      
      // GridCoreì™€ GridRendererë¥¼ ì§ì ‘ ì‚¬ìš© (PureSheet ë¹Œë“œ ì „)
      const { GridCore, GridRenderer } = await import('../src/index.ts');
      
      const columns = [
        { key: 'id', header: 'ID', width: 60, pinned: 'left' },
        { key: 'name', header: 'Name', width: 150 },
        { key: 'email', header: 'Email', width: 250 },
        { key: 'department', header: 'Department', width: 120 },
        { key: 'status', header: 'Status', width: 100 },
        { key: 'salary', header: 'Salary', width: 100, formatter: (v) => '$' + v.toLocaleString() },
        { key: 'joinDate', header: 'Join Date', width: 120 },
      ];
      
      const gridCore = new GridCore({ columns });
      await gridCore.initialize();
      
      const renderer = new GridRenderer(container, {
        gridCore,
        options: {
          columns,
          rowHeight: 36,
          headerHeight: 40,
          resizableColumns: true,
          reorderableColumns: true,
          theme: 'light',
        },
        onRowClick: (rowIndex, row) => {
          console.log('Row clicked:', rowIndex, row);
          updateSelectedRows([row]);
        },
      });
      
      // ì„ì‹œë¡œ sheet ê°ì²´ ìƒì„± (loadData í•¨ìˆ˜ìš©)
      sheet = {
        loadData: async (data) => {
          await gridCore.loadData(data);
          renderer.refresh();
        },
        selectAll: () => {
          console.log('Select all - not implemented in demo');
        },
        clearSelection: () => {
          console.log('Clear selection - not implemented in demo');
        },
      };
      
      // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
      await window.loadData(1000);
    }
    
    init().catch(console.error);
  </script>
</body>
</html>
